LAMMPS (28 Mar20 2016-ICMS)
# LAMMPS

variable	xx equal 300
variable	yy equal 300
variable	zz equal 300


units		real
atom_style	atomic

lattice		fcc 10
Lattice spacing in x,y,z = 10 10 10
region		box block 0 ${xx} 0 ${yy} 0 ${zz} units box
region		box block 0 300 0 ${yy} 0 ${zz} units box
region		box block 0 300 0 300 0 ${zz} units box
region		box block 0 300 0 300 0 300 units box
boundary p p p
create_box	1 box
Created orthogonal box = (0 0 0) to (300 300 300)
  3 by 3 by 3 MPI processor grid

region fluidregion block 0 ${xx} 0 ${yy} 0 ${zz} units box
region fluidregion block 0 300 0 ${yy} 0 ${zz} units box
region fluidregion block 0 300 0 300 0 ${zz} units box
region fluidregion block 0 300 0 300 0 300 units box
region constrainreg block 0 ${xx} 180 200  0 ${zz} units box
region constrainreg block 0 300 180 200  0 ${zz} units box
region constrainreg block 0 300 180 200  0 300 units box

create_atoms 1 region fluidregion units box
Created 108000 atoms

mass		1 1.0

velocity	all create 1000.0 87287 loop geom

pair_style	lj/cut 10
pair_coeff	1 1 2.5 3.4

neighbor	2.0 bin
neigh_modify delay 0 every 1 check yes

variable dx equal 20
variable dy equal 20
variable dz equal 20 


thermo 10

fix		1 all nve

# Equilibrate before coupling
run 10
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6 -> bins = 50 50 50
Memory usage per processor = 2.64967 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0         1000   -79092.965            0    242831.54    148.33583 
      10    1013.9826   -86035.742            0     240390.1     122.0072 
Loop time of 4.85269 on 27 procs for 10 steps with 108000 atoms

Performance: 0.178 ns/day, 134.797 hours/ns, 2.061 timesteps/s
14.4% CPU use with 27 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.0127     | 0.013918   | 0.023818   |   1.8 |  0.29
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 2.2227     | 2.4946     | 2.9266     |  10.4 | 51.41
Output  | 0.56496    | 0.62349    | 0.70787    |   4.6 | 12.85
Modify  | 0.00091147 | 0.0019098  | 0.020963   |   8.6 |  0.04
Other   |            | 1.719      |            |       | 35.42

Nlocal:    4000 ave 4000 max 4000 min
Histogram: 27 0 0 0 0 0 0 0 0 0
Nghost:    3813 ave 3813 max 3813 min
Histogram: 27 0 0 0 0 0 0 0 0 0
Neighs:    36000 ave 36000 max 36000 min
Histogram: 27 0 0 0 0 0 0 0 0 0

Total # of neighbors = 972000
Ave neighs/atom = 9
Neighbor list builds = 0
Dangerous builds = 0

# IMPORTANT for not messing the internal average for BCs in the CPLSocket for LAMMPS
reset_timestep 0

compute vfieldcompute all chunk/atom bin/2d x lower ${dx} z  lower ${dz} ids every region constrainreg units box
compute vfieldcompute all chunk/atom bin/2d x lower 20 z  lower ${dz} ids every region constrainreg units box
compute vfieldcompute all chunk/atom bin/2d x lower 20 z  lower 20 ids every region constrainreg units box
# The output shows the middle coordinate of each box (10, 10, 10) for the first box in this case
fix vfieldfix all ave/chunk 1 1 1 vfieldcompute vx vy vz norm all file lammps_vels.dat

region cfdbcregion block 0.000000 300.000000 180.000000 200.000000 0.000000 300.000000 units box
compute cfdbccompute all chunk/atom bin/2d x lower 20 z lower 20 ids every region cfdbcregion units box
fix cfdbcfix all ave/chunk 1 1 1 cfdbccompute vx vy vz norm all 
run 0
Memory usage per processor = 2.93057 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0    1013.9826   -86035.742            0     240390.1     122.0072 
Loop time of 0.12948 on 27 procs for 0 steps with 108000 atoms

14.2% CPU use with 27 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0          | 0          | 0          |   0.0 |  0.00
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.1295     |            |       |100.00

Nlocal:    4000 ave 4044 max 3966 min
Histogram: 1 2 3 11 2 3 2 0 0 3
Nghost:    3813 ave 3847 max 3769 min
Histogram: 3 0 0 2 3 2 11 3 2 1
Neighs:    48869.2 ave 49707 max 48392 min
Histogram: 3 3 6 5 3 3 1 2 0 1

Total # of neighbors = 1319468
Ave neighs/atom = 12.2173
Neighbor list builds = 0
Dangerous builds = 0
region cplforceregion block 0.000000 300.000000 280.000000 300.000000 0.000000 300.000000 units box
group cplforcegroup dynamic all region cplforceregion every 1
dynamic group cplforcegroup defined
fix cplforcefix all cpl/force region cplforceregion
run 1
Memory usage per processor = 2.93057 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0    1013.9826   -86035.742            0     240390.1     122.0072 
       1    1016.9155   -86971.409            0    240398.62    119.17794 
Loop time of 1.70849 on 27 procs for 1 steps with 108000 atoms

Performance: 0.051 ns/day, 474.582 hours/ns, 0.585 timesteps/s
14.3% CPU use with 27 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00266    | 0.002782   | 0.0031435  |   0.2 |  0.16
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.19306    | 0.23015    | 0.26933    |   4.8 | 13.47
Output  | 0.60001    | 0.63526    | 0.67201    |   2.9 | 37.18
Modify  | 0.5681     | 0.60804    | 0.64416    |   2.7 | 35.59
Other   |            | 0.2323     |            |       | 13.59

Nlocal:    4000 ave 4044 max 3966 min
Histogram: 1 2 3 11 2 3 2 0 0 3
Nghost:    3813 ave 3847 max 3769 min
Histogram: 3 0 0 2 3 2 11 3 2 1
Neighs:    48869.2 ave 49707 max 48392 min
Histogram: 3 3 6 5 3 3 1 2 0 1

Total # of neighbors = 1319468
Ave neighs/atom = 12.2173
Neighbor list builds = 0
Dangerous builds = 0
Total wall time: 0:00:35
